

CREATE SCHEMA BIBLIOTECA

CREATE TABLE BIBLIOTECA.AUTOR
(
 CODIGO INT PRIMARY KEY NOT NULL --MANERA 1
,NOMBRE VARCHAR(30) NOT NULL
) 

CREATE TABLE BIBLIOTECA.LIBRO
(
 CODIGO_LIBRO INT PRIMARY KEY NOT NULL --MANERA 1
,TITULO       VARCHAR(50) NOT NULL
,ISBN         VARCHAR(15) NOT NULL
,PAGINAS      INT NOT NULL
,EDITORIAL    VARCHAR(25)
)

CREATE TABLE BIBLIOTECA.AUTOR_LIBRO
(
 CODIGO_AUTOR INT NOT NULL
,CODIGO_LIBRO INT NOT NULL
--,PRIMARY KEY(CODIGO_AUTOR,CODIGO_LIBRO) --MANERA 2
,CONSTRAINT PK_AUTOR_LIBRO PRIMARY KEY (CODIGO_AUTOR,CODIGO_LIBRO) --MANERA 3
,FOREIGN KEY (CODIGO_AUTOR) REFERENCES BIBLIOTECA.AUTOR(CODIGO)
,FOREIGN KEY (CODIGO_LIBRO) REFERENCES BIBLIOTECA.LIBRO(CODIGO_LIBRO)
)



CREATE TABLE BIBLIOTECA.LIBRO_EJEMPLAR
(
 CODIGO_LIBRO    INT NOT NULL
,CODIGO_EJEMPLAR INT NOT NULL
,CONSTRAINT PK_LIBRO_EJEMPLAR PRIMARY KEY (CODIGO_LIBRO,CODIGO_EJEMPLAR)
,FOREIGN KEY (CODIGO_LIBRO) REFERENCES BIBLIOTECA.LIBRO(CODIGO_LIBRO)
,FOREIGN KEY (CODIGO_EJEMPLAR) REFERENCES BIBLIOTECA.EJEMPLAR(CODIGO_EJEMPLAR)
)



CREATE TABLE BIBLIOTECA.USUARIO_EJEMPLAR
(
 CODIGO_USUARIO   INT NOT NULL
,CODIGO_EJEMPLAR  INT NOT NULL
,FECHA_PRESTAMO   DATETIME NOT NULL
,FECHA_DEVOLUCION DATE NOT NULL
,CONSTRAINT PK_USUARIO_EJEMPLAR PRIMARY KEY (CODIGO_USUARIO,CODIGO_EJEMPLAR)
,FOREIGN KEY (CODIGO_EJEMPLAR) REFERENCES BIBLIOTECA.EJEMPLAR(CODIGO_EJEMPLAR)
,FOREIGN KEY (CODIGO_USUARIO) REFERENCES BIBLIOTECA.USUARIO(CODIGO_USUARIO)
)


USE IF4100_TURRIALBA_B03103
---RESOLUCION DEL QUIZ

--A)
CREATE TABLE BIBLIOTECA.LOCALIZACION
(
ID_LOCALIZACION INT PRIMARY KEY NOT NULL
,RECINTO VARCHAR(25) NOT NULL
)

--B)
CREATE TABLE BIBLIOTECA.EJEMPLAR
(
CODIGO_EJEMPLAR INT PRIMARY KEY NOT NULL
,LOCALIZACION   INT
,FOREIGN KEY (LOCALIZACION) REFERENCES BIBLIOTECA.LOCALIZACION(ID_LOCALIZACION)
)

----C)
--1	Turrialba
--2	Paraiso
--3	Guapiles
--4	San Ramon
--5	San Pedro
--6	Grecia
--7	Liberia
--8	Limon

INSERT INTO BIBLIOTECA.LOCALIZACION
(
[ID_LOCALIZACION]
, [RECINTO]
)
VALUES
(1,'Turrialba')
,(2,'Paraiso')
,(3,'Guapiles')
,(4,'San Ramon')
,(5,'San Pedro')
,(6, 'Grecia')
,(7,'Liberia')
,(8,'Limon')

SELECT * FROM BIBLIOTECA.LOCALIZACION

--D) 
CREATE TABLE BIBLIOTECA.USUARIO
(
 CODIGO_USUARIO INT PRIMARY KEY NOT NULL
,NOMBRE         VARCHAR(20) NOT NULL
,APELLIDOS      VARCHAR(40) NOT NULL
,TELEFONO       VARCHAR(10) NULL
,DIRECCION      VARCHAR(100) NOT NULL
,CARRERA        VARCHAR(40) NOT NULL
,LOCALIZACION   INT NOT NULL
,FOREIGN KEY (LOCALIZACION) REFERENCES BIBLIOTECA.LOCALIZACION(ID_LOCALIZACION)
)


--INSERCION DE DATOS (ESTUDIANTES NUEVOS)
INSERT INTO BIBLIOTECA.USUARIO
(
  [CODIGO_USUARIO]
, [NOMBRE]
, [APELLIDOS]
, [TELEFONO]
, [DIRECCION]
, [CARRERA]
, [LOCALIZACION]
)
VALUES
(
10000
,'Aracely'
,'Soto'
,'84848484'
,'Cartago, Turrialba'
,'Informatica'
,1
)
,(
10001
,'Fabricio'
,'Castillo'
,'25529696'
,'San Jose,San Pedro, Calle 2'
,'Direccion Empresas'
,5
)
,(
10002
,'Michelle'
,'Molina'
,'85658565'
,'Cartago, Central, Oriental'
,'Turismo'
,2
),
(
10003
,'Yareth'
,'Fernandez'
,'25547896'
,'Siquirres, Calle 23'
,'Informatica'
,8
)

select * from BIBLIOTECA.USUARIO

INSERT INTO [BIBLIOTECA].[LIBRO]
(
[CODIGO_LIBRO], [TITULO], [ISBN], [PAGINAS], [EDITORIAL]
)
VALUES
(
1,'El Principito','abcdefg123',100,'EditorialClubdeLibros'
),(
2,'SQL Server MVP','12345678r',787,'Manning Publications'
),(
3,'Harry Potter','gfgfgfgf',890,'HarryHarry'
),(
4,'El Padrino','4545jhjh',568,'Ediciones Perro Azul'
),(
5,'El Quijote','quiquiqui',1234,'Ed Barcelona'
),(
6,'Harry Potter Piedra F','abcdefg124',1234,'HarryHarry'
),(
7,'Harry Potter 2020','abcdefg125',790,'HarryHarry'
),(
8,'Harry Potter Inicios','abcdefg126',345,'HarryHarry'
),(
9,'El Androide','12grg',560,'Ediciones Perro Azul'
),(
10,'El Androide','12grd',590,'Ediciones Perro Azul'
)

INSERT INTO [BIBLIOTECA].[EJEMPLAR]
(
[CODIGO_EJEMPLAR], [LOCALIZACION]
)
VALUES
(
1000,1
),(
1001,1
),(
1010,2
),(
1020,3
),(
2000,1
),(
3000,3
),(
4000,2
),(
5000,1
)


INSERT INTO [BIBLIOTECA].[LIBRO_EJEMPLAR]
(
[CODIGO_LIBRO], [CODIGO_EJEMPLAR]
)
VALUES
(
1,1000
),(
1,1001
),(
1,1010
),(
1,1020
),(
2,2000
),(
3,3000
),(
4,4000
),(
5,5000
)

SELECT * FROM [BIBLIOTECA].[USUARIO_EJEMPLAR]

INSERT [BIBLIOTECA].[USUARIO_EJEMPLAR] ([CODIGO_USUARIO], [CODIGO_EJEMPLAR], [FECHA_PRESTAMO], [FECHA_DEVOLUCION]) VALUES (10000, 1001, CAST(N'2020-08-20T09:37:36.387' AS DateTime), CAST(N'2020-08-27' AS Date))
INSERT [BIBLIOTECA].[USUARIO_EJEMPLAR] ([CODIGO_USUARIO], [CODIGO_EJEMPLAR], [FECHA_PRESTAMO], [FECHA_DEVOLUCION]) VALUES (10001, 3000, CAST(N'2020-08-19T10:45:36.387' AS DateTime), CAST(N'2020-08-26' AS Date))
INSERT [BIBLIOTECA].[USUARIO_EJEMPLAR] ([CODIGO_USUARIO], [CODIGO_EJEMPLAR], [FECHA_PRESTAMO], [FECHA_DEVOLUCION]) VALUES (10002, 1000, CAST(N'2020-08-10T08:00:36.387' AS DateTime), CAST(N'2020-08-17' AS Date))